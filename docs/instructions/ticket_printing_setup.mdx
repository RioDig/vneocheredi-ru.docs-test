---
sidebar_position: 19.01
---

import ImageContainer from "../../src/components/ImageContainer";
import {Code} from "@mui/icons-material"

# Инструкция по настройке работы системы с использованием бумажных талонов {#ticket_printing_setup}

:::note PDF-версия инструкции
Перейдите по [ссылке](ticket_printing_setup.pdf). Инструкция откроется в новом окне.
:::

В этой инструкции рассмотрены необходимые действия для работы очереди с талонами и их печатью.

Терминалы типа «Веб-терминал» поддерживают возможность печати бумажных талонов при записи в очередь. Талоны позволяют идентифицировать клиента в очереди даже без указания персональных данных \(ФИО, телефон, название компании, электронная почта\). Операторы точек обслуживания смогут видеть в мониторинге позиции по талонам и сверять значение с тем талоном, какой имеет клиент.

<ImageContainer src={"/images/troubleshooting/ticket_printing_setup/example_monitoring_with_position.png"} description={"Пример настройки очереди с талонами. Клиент записался через терминал, не указывая персональных данных. В мониторинге отобразилась позиция только с номером талона."}/>

При помощи талонов возможна настройка терминалов типа «Экран вызова», чтобы они отображали позиции с талонами, а голосовой вызов осуществляется произношением номера талона.

<ImageContainer src={"/images/troubleshooting/ticket_printing_setup/example_callscreen.png"} description={"Пример экрана терминала типа «Экран вызова» с позицией, добавленной через терминал, у которой есть номер талона."}/>

Талоны в очередях могут использоваться в разных случаях, например если нужна печать бумажных талонов при записи в очередь или если требуется создать маршрутную очередь, где важно идентифицировать клиентов по талону.

---

Чтобы настроить работу системы с бумажными талонами:
-   [Включите режим «Бумажные билеты» в настройках очереди (шаг 2)](#step2)
-   [Включите отображение номеров талона для сотрудников в административной панели на странице мониторинга очереди (шаг 3)](#step3)
-   [Включите отображение номера талона на терминале типа «Экран вызова» (шаг 5)](#step5)
-   [Настройте терминал типа «Веб-терминал» для печати бумажного талона (шаг 6)](#step6)
-   [Настройте шаблоны сообщений для голосового вызова и текст для бумажных талонов (шаг 7)](#step7)
-   [Настройте печать талона на устройстве терминала (шаг 8)](#step8)

Ниже приведены подробные шаги для включения талонов в очереди, их отображении в качестве персональных данных в мониторинге и на терминале типа «Экран вызова», печати талонов и настройке шаблона талона:
1.  Создайте и настройте новое место и очереди или убедитесь в правильности их настройки для своих целей.
    Подробнее см. в разделах
    [Создание и настройка места](http://docs.ocheredi.com/topics/shops_management/shops_creation_and_settings.html),
    [Создание очереди](http://docs.ocheredi.com/topics/lines_management/line_creation/line_creation.html) и
    [Настройка очереди](http://docs.ocheredi.com/topics/lines_management/line_settings/line_settings.html).
2.  Чтобы включить возможность печатать бумажные талоны при записи в очередь через терминал: <a id="step2"></a>
    1.  Перейдите в настройки параметров очереди → группа настроек «Режимы».
        :step_result: откроется страница настройки режимов очереди.
        <ImageContainer src={"/images/lines_management/line_settings/operating_settings.png"} description={"Группа настроек очереди — «Режимы»"}/>
    2.  Включите режим «Бумажные билеты».
    3.  Нажмите «Сохранить».
        :step_result: внизу страницы появится всплывающее уведомление «Очередь успешно обновлена».
3.  Чтобы номер талона отображался как персональные данные в мониторинге: <a id="step3"></a>
    1.  Перейдите в настройки параметров очереди → группа настроек «Персональные данные участников».
        :step_result: откроется страница настройки отображения персональных данных.
        <ImageContainer src={"/images/lines_management/line_settings/personal_info_settings.png"} description={"Группа настроек очереди — «Персональные данные участников»"}/>
    2.  Включите опцию «Отображать номер талона». Эта опция позволит отображать номер талона в качестве персональных данных позиции на странице мониторинга.
        <ImageContainer src={"/images/troubleshooting/ticket_printing_setup/ticket_number_personal_example.png"} description={"Номер талона «Б1Ч5» отображается в строке персональных данных"}/>
    3.  Нажмите «Сохранить».
        :step_result: внизу страницы появится всплывающее уведомление «Очередь успешно обновлена».
4.  Чтобы включить окно с информацией о записи после ее создания:
    1.  Перейдите в настройки параметров очереди → группа настроек «Мониторинг».
        :step_result: откроется страница настройки мониторинга.
        <ImageContainer src={"/images/lines_management/line_settings/monitoring_settings.png"} description={"Группа настроек очереди — «Мониторинг»"}/>
    2.  Включите опцию «Показывать окно с информацией о записи после её создания». Эта опция добавит окно, вызываемое сразу после добавления позиции. Если номер талона был настроен как персональные данные клиента, то в этом окне появится номер талона.
        <ImageContainer src={"/images/lines_management/line_settings/monitoring_settings/posititon_window_after_add.png"} description={"Пример окна после добавления позиции с персональными данными клиента, включая номер талона, если он был настроен как персональные данные."}/>
        :::tip
        При помощи этого окна сотрудник сможет распечатать талон аналогично тому, как если бы клиент записывался самостоятельно через терминал с талонами.
        :::
5.  Чтобы включить отображение талона на терминалах типа «Экран вызова»: <a id="step5"></a>
    1.  Создайте или убедитесь в правильности настройки терминала типа «Экран вызова», подробнее см. в разделе [Экран вызова](http://docs.ocheredi.com/topics/terminal_management/terminal_creation.html#infopad).
    2.  С главной страницы перейдите на страницу «Терминалы» и выберите нужный терминал.
        :step_result: откроется страница информации о терминале.
    3.  Нажмите «Редактировать».
        :step_result: откроется страница редактирования параметров терминала.
        <ImageContainer src={"/images/troubleshooting/ticket_printing_setup/terminal_callscreen_example.png"} description={"Редактирование параметров терминала типа «Экран вызова»"}/>
    4.  Включите опцию «Отображать номер талона».
    5.  Убедитесь, что в блоке «Места» выбраны правильные очереди. Позиции с этих очередей будут появляться на экране вызова.
    6.  Нажмите «Сохранить».
        :step_result: внизу страницы появится всплывающее уведомление «Терминал успешно обновлен».
6.  Создайте новый терминал типа «Веб-терминал» или настройте уже созданный для печати талонов: <a id="step6"></a>
    1.  Создайте или убедитесь в правильности настройки терминала типа «Веб-терминал»,
        подробнее см. в разделе [Веб-терминал](http://docs.ocheredi.com/topics/terminal_management/terminal_creation.html#kiosk).
    2.  С главной страницы перейдите на страницу «Терминалы» и выберите нужный терминал.
        :step_result: откроется страница информации о терминале.
    3.  Нажмите «Редактировать».
        :step_result: откроется страница редактирования параметров терминала.
        <ImageContainer src={"/images/troubleshooting/ticket_printing_setup/terminal_kiosk_example.png"} description={"Редактирование параметров терминала типа «Веб-терминал»"}/>
    4.  В блоке «Оборудование» включите опцию «Термопринтер». Эта опция позволит терминалу начинать печать талона после записи в очередь.
    5.  Убедитесь, что в блоке «Места» выбраны правильные очереди, в которое клиент сможет записаться через терминал.
    6.  Нажмите «Сохранить».
    :step_result: внизу страницы появится всплывающее уведомление «Терминал успешно обновлен».
7.  Чтобы настроить текст на бумажном талоне и сообщение для голосового вызова на терминале типа «Экран вызова»: <a id="step7"></a>
    1.  С главной страницы перейдите на страницу «Глобальные шаблоны сообщений».
        :step_result: откроется страница редактирования шаблонов сообщений для разных языков.
    2.  Настройте шаблон для бумажного билетика:
        1.  Раскройте вкладку «Другие» и выберите «Бумажный билетик».
            <ImageContainer src={"/images/troubleshooting/ticket_printing_setup/message_template_page.png"} description={"Настройка текста для голосового вызова"}/>
        2.  В поле «Текст» справа введите текст, который будет печататься при записи через терминал.
        3.  Нажмите «Сохранить».
    3.  Настройте шаблон для голосового вызова:
        1.  Раскройте вкладку «Другие» и выберите «Голосовой вызов».
            <ImageContainer src={"/images/troubleshooting/ticket_printing_setup/message_template_page_ticket.png"} description={"Настройка текста для бумажного билетика"}/>
        2.  В поле «Текст» справа введите текст, который будет произноситься при голосовом вызове на терминале типа «Экран вызова».
        3.  Нажмите «Сохранить».
    :::info
    Шаблоны сообщений поддерживают вставку переменных, на место которых будет подставляться значение. Например:
    -   \{\{LineName\}\} — название очереди.
    -   \{\{ServiceName\}\} — название услуги.
    -   \{\{CheckpointName\}\} — название точки обслуживания.
    -   \{\{ReservationCode\}\} — номер талона.
    Для получения полного списка переменных нажмите «<Code/>».
    :::
8.  Подготовьте пакетный файл \(.bat\) для настройки печати талона на терминале: <a id="step8"></a>
    1.  Создайте файл расширения .bat с произвольным названием.
    2.  Вставьте в файл следующий код:
        :::info
        Ниже представлен пример файла для терминалов, использующих Google Chrome.
        ```shell
        
        taskkill /IM "chrome.exe">nul 2>&1
        
        set chrome_path="%ProgramFiles%\Google\Chrome\Application\chrome.exe"
        
        set app_url="**ваш\_url\_терминала**"
        
        set chrome_flags= --kiosk --kiosk-printing --disable-pinch --disable-session-crashed-bubble --disable-infobars
        
        %chrome_path% %app_url% %chrome_flags%                                
                                    
        ```
        :::
    3.  В блоке app\_url вместо **ваш\_url\_терминала** вставьте ссылку на терминал типа «Веб-терминал».
        Ссылка на терминал формируется следующим образом:<br/>
        `https://call.{ваш домен}/terminal/?terminalId={GUID}&languages=ru&monitoring=false`
        -   \{ваш домен\} — доменное имя вашей системы.
        -   \{GUID\} — уникальный идентификтор терминала, который расположен на странице терминала \(Главная → Терминалы → нужный терминал\).
    4.  Сохраните файл.
